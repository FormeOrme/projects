<!DOCTYPE html>
<html lang="en">

<head>
    <script src="../util.js"></script>
    <meta charset="utf-8" />
    <style>
        html,
        body {
            margin: 0;
            padding: 0;
        }
    </style>
</head>

<body>
    <script>
        const text = `    <svg version="1.1" width="300" height="200" xmlns="http://www.w3.org/2000/svg">
        <rect width="100%" height="100%" fill="red" />
        <circle cx="150" cy="100" r="80" fill="green" />
    </svg>`;

        function parse(source) {
            const svg = (new DOMParser()).parseFromString(source, `image/svg+xml`);
            console.log(parseNode(svg.firstChild));
            console.log(svg.firstChild.childNodes);
        }

        function parseNode(node) {
            const tag = SUtils.capitalize(node.tagName);
            const attribute = `attribute:{${[...node.attributes].map(att => `"${att.nodeName}":"${att.value}"`)}}`;
            const children = `children:[${[...node.childNodes].filter(t => !(t instanceof Text)).map(child => parseNode(child))}]`
            return `${tag}.with({${[attribute, children].join(",")}})`;
        }

        const tassellation = [];
        for (let y = 0; y < 5; y++) {
            for (let x = 0; x < 5; x++) {
                tassellation.push(Rect.with({
                    attribute: {
                        width: 100,
                        height: 100,
                        x: x * 100,
                        y: y * 100,
                        fill: "none",
                        stroke: "#000",
                    }
                }),)
            }
        }

        document.body.append(Svg.with({
            attribute: { "xmlns": "http://www.w3.org/2000/svg", "version": "1.1", "width": "500", "height": "500" },
            children: tassellation
        }).create({ namespace: "http://www.w3.org/2000/svg" }))
    </script>

</body>

</html>